<!doctype html>
<html>
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131298185-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-131298185-1');
    </script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Python++</title>

    <link rel="stylesheet" href="reveal/css/reveal.css">
    <link rel="stylesheet" href="reveal/css/theme/black.css" id="theme">
    <link rel="stylesheet" href="reveal/lib/css/solarized-dark.css">
    <link rel="stylesheet" href="reveal/css/custom.css">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal/css/print/pdf.css' : 'reveal/css/print/paper.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>
</head>
<body>
<div class="reveal">
    <div class="slides">

        <!-- Title -->
        <section>
            <h1>Python++</h1>
            <p><i>linux.conf.au 2019</i></p>
            <p>
                <small>Jan Groth</small>
            </p>
        </section>

        <!-- Intro -->
        <section>
            <section>
                <h2>About me</h2>
                <ul>
                    <li>DevOps Engineer at Versent* in Sydney**</li>
                    <li>Developer Background</li>
                </ul>
                </p>
                <p>
                    <small class="fragment">
                        (*) We are hiring<br/>
                        (**) In Sydney and Melbourne
                    </small>
                </p>
            </section>
            <section>
                <h2>This talk</h2>
                <p>
                    <ul class="fragment">
                        <li class="fragment strike">I'm a Python guru, here are 10 Python features - now start using them!</li>
                        <li class="fragment">Things that I find useful when writing code Python</li>
                        <li class="fragment">Don't take notes</li>
                    </ul>
                </p>
            </section>
        </section>

        <!-- Python3 & venv -->
        <section>
            <section>
                <h2>What year is this?</h2>
            </section>
            <section>
                <ul>
                    <li><strong>The Dark Knight</strong> is the most popular movie</li>
                    <li><strong>Lehman Brothers</strong> file for bankruptcy</li>
                    <li><strong>Spotify</strong> launches in Sweden</li>
                    <li><strong>Lady Gaga</strong> has number-one singles with <strong>Just Dance</strong> and <strong>Poker Face</strong></li>
                </ul>
            </section>
            <section>
                <h1>2008</h1>
            </section>
            <section>
                <blockquote><strong>Python 3.0</strong> was released on December 3, <strong>2008</strong></blockquote>
                <blockquote>It was designed to <strong>rectify fundamental design flaws</strong> in the language—the changes required could not be implemented while retaining full backwards compatibility with the 2.x series, which necessitated a <strong>new major version</strong> number</blockquote>
                <p>
                    <small>
                        Source: Wikipedia
                    </small>
                </p>
            </section>
            <section>
                <p>Python 2</p>
                <p>or</p>
                <p>Python 3?</p>
            </section>
            <section>
                <p>Best reason to stop using Python 2.7 <strong>now</strong>:</p>
                <iframe src="https://free.timeanddate.com/countdown/i6k6by43/n951/cf100/cm0/cu5/ct4/cs0/cacffffce/co0/cr0/ss0/cacfff/cpc000/pct/tcfff/fn3/fs250/szw576/szh243/iso2020-01-01T00:00:00/bas5/bacf00/pa10" allowTransparency="true" frameborder="0" width="605" height="272"></iframe>
            </section>
            <section>
                <p>Python <strong>versions</strong> and project <strong>dependencies</strong></p>
            </section>
            <section>
                    <p>One Python environment <strong>per project</strong></p>
                    <p>! <strong>Don't</strong> use the system environment</p>
            </section>
            <section>
                    <p>Project dependencies as <strong>unspecific as possible</strong></p>
                    <p>Declare <strong>only direct</strong> dependencies<br/>
                        Ignore transitive dependencies</p>
            </section>
            <section>
                <p>Installing <em>boto3</em> and <em>pyyaml</em>...</p>
                <div class="fragment">
                    <p><em>requirements.txt</em>:</p>
                    <div class="left">
                        <pre data-badge="&#10008;" data-badge-fg="#dc322f;">
                            <code class="bash" data-trim data-noescape>
                                boto3==1.9.71
                                botocore==1.12.71
                                docutils==0.14
                                jmespath==0.9.3
                                python-dateutil==2.7.5
                                PyYAML==3.13
                                s3transfer==0.1.13
                                six==1.12.0
                                urllib3==1.24.1
                            </code>
                        </pre>
                    </div>
                <div class="right">
                    <pre data-badge="&#10004;" data-badge-fg="#859900;">
                        <code class="bash" data-trim data-noescape>
                            boto3
                            PyYAML
                        </code>
                    </pre>
                </div>
                </div>
            </section>
            <section data-background="#f7f2d3">
                <h2>Tip #1</h2>
                <p>Stay ahead of Python's versions</p>
                <ul>
                    <li>Use Python 3</li>
                    <li>Use a tool to manage dependencies</li>
                    <ul>
                        <li>venv</li>
                        <li>pipenv</li>
                        <li>docker & venv</li>
                    </ul>
                </ul>
            </section>
        </section>

        <!-- Conventions  & good naming -->
        <section data-state="changeToBlack">
            <section>
                <h2>Readability</h2>
            </section>
            <section>
                <p>Write <strong>once</strong>. Read <strong>many</strong> times.</p>
            </section>
            <section>
                <p>More conventions - less thinking ...</p>
                <pre data-badge="&#10004;" data-badge-fg="#859900;">
                    <code class="python" data-trim data-noescape>
                        CONSTANTS_IN_UPPERCASE = 123

                        variables_are_lowercase = 'OH YES!'

                        def methods_are_lowercase_too():
                            pass

                        def all_use_kebap_case():
                            pass
                    </code>
                </pre>
            </section>
            <section>
                <p>File names...</p>
                <pre data-badge="&#10008;" data-badge-fg="#dc322f;">
                    <code class="bash" data-trim data-noescape>
                        lambda.py
                        nexus.py
                    </code>
                </pre>
                <pre data-badge="&#10004;" data-badge-fg="#859900;">
                    <code class="bash" data-trim data-noescape>
                        rewards-calculation-lambda.py
                        query-nexus-for-latest-snapshot.py
                    </code>
                </pre>
            </section>
            <section>
                <p>Method names...</p>
                <pre data-badge="&#10008;" data-badge-fg="#dc322f;">
                    <code class="python" data-trim data-noescape>
                        # creates new sftp client
                        def sftp_client(username, password):
                            pass
                    </code>
                </pre>
                <pre data-badge="&#10004;" data-badge-fg="#859900;">
                    <code class="python" data-trim data-noescape>
                        def create_sftp_client(username, password):
                            pass
                    </code>
                </pre>
            </section>
            <section>
                <p>Complex code ...</p>
                <pre data-badge="&#10008;" data-badge-fg="#dc322f;">
                    <code class="python" data-trim data-noescape>
                        # scale out if less than 3 instances
                        if len(current_instances) < 3:
                            add_instance()
                    </code>
                </pre>
                <pre data-badge="&#10004;" data-badge-fg="#859900;">
                    <code class="python" data-trim data-noescape>
                        if should_scale_out(current_instances):
                            add_instance()
                    </code>
                </pre>
            </section>
            <section data-background="#f7f2d3">
                <h2>Tip #2</h2>
                <p>Use language conventions</p>
                <p>Make an effort to find good names</p>
                <p>Introduce methods to increase readability</p>
            </section>
        </section>

        <!-- Beauty lies in simplicity -->
        <section>
            <section>
                <h2>Writing beautiful code</h2>
            </section>
            <section>
                <p>There is <strong>beauty</strong> in <strong>simplicity</strong>.</p>
            </section>
            <section>
                <div class="left">
                    <pre data-badge="&#10008;" data-badge-fg="#dc322f;">
                        <code class="python" data-trim data-noescape>
                            counter = 0
                            while counter < 5:
                                print(counter)
                                counter += 1
                        </code>
                    </pre>
                </div>
                <div class="right">
                    <pre data-badge="&#10004;" data-badge-fg="#859900;">
                        <code class="python" data-trim data-noescape>
                            for i in range(5):
                                print(i)
                        </code>
                    </pre>
                </div>
            </section>
            <section>
                There is often a <strong>pythonic</strong> way
            </section>
            <section>
                <p><strong>Loop</strong> vs <strong>List Comprehension</strong></p>
                    <pre data-badge="&#10008;" data-badge-fg="#dc322f;">
                        <code class="python" data-trim data-noescape>
                        symbols = '$¢£¥€¤'
                        codes = []
                        for symbol in symbols:
                            codes.append(ord(symbol))

                        >>> [36, 162, 163, 165, 8364, 164]
                        </code>
                    </pre>
                <pre data-badge="&#10004;" data-badge-fg="#859900;">
                        <code class="python" data-trim data-noescape>
                            symbols = '$¢£¥€¤'
                            codes = [ord(symbol) for symbol in symbols]

                            >>> [36, 162, 163, 165, 8364, 164]
                        </code>
                    </pre>
            </section>
            <section data-transition="fade-in">
                <p>Commenting every single line is essential ...</p>
            </section>
            <section data-transition="fade-in">
                <p>..if you are writing in Assembler.</p>
                <pre>
                    <code class="assembler" data-trim data-noescape>
                        flash2ram:
                                lpm                 ;get constant
                                st      Y+,r0       ;store in SRAM and increment Y-pointer
                                adiw    ZL,1        ;increment Z-pointer
                                dec     flashsize
                                brne    flash2ram   ;if not end of table, loop more
                                ret
                    </code>
                </pre>
            </section>
            <section data-transition="fade-in">
                <p>In Python not so much.</p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        def pfPasswordHash(arg):
                            # Randomise Salt
                            salt = os.urandom(6)
                            # Convert String to Byte Array
                            res = arg.encode()
                            # Hash through 10000 times.
                            for lp in range(100000):
                                # Always initialize hashlib, because [...]
                                m = hashlib.sha256()
                                # Swap between the two inputs into the digest based on loop number
                                m.update(res) if lp % 2 else m.update(salt)
                                m.update(salt) if lp % 2 else m.update(res)
                                # Finish the digest
                                res = m.digest()
                    </code>
                </pre>
            </section>
            <section data-transition="fade-in">
                <p>In Python not so much.</p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        def pfPasswordHash(arg):
                            <strike># Randomise Salt</strike>
                            salt = os.urandom(6)
                            <strike class="strike"># Convert String to Byte Array</strike>
                            res = arg.encode()
                            <strike class="strike"># Hash through 10000 times.</strike>
                            for lp in range(100000):
                                <mark># Always initialize hashlib, because [...]</mark>
                                m = hashlib.sha256()
                                <strike class="strike"># Swap between the two inputs into the digest based on loop number</strike>
                                m.update(res) if lp % 2 else m.update(salt)
                                m.update(salt) if lp % 2 else m.update(res)
                                <strike class="strike"># Finish the digest</strike>
                                res = m.digest()
                    </code>
                </pre>
            </section>
            <section data-background="#f7f2d3">
                <h2>Tip #3</h2>
                <p>Write code that is both functional and simple</p>
                <p>Use Python idioms where you can</p>
                <p>Comment only what you cannot say in code</p>
            </section>
        </section>

        <!-- Scope & classes -->
        <section>
            <section>
                <h2>Classes</h2>
            </section>
            <section>
                <p>A <strong>basic</strong> calculator</p>
            </section>
            <section data-transition="slide-in fade-out">
                <p>Calculations on top of a <strong>base</strong> number</p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        base = 10

                        def multiply(number):
                            return base * number

                        def add(number):
                            return base + number

                        print(multiply(5))  # ...50
                        print(add(7))       # ...12



                        .
                    </code>
                </pre>
            </section>
            <section>
                <p>Time passes ...</p>
            </section>
            <section data-transition="slide-in fade-out">
                <p>New requirements are coming in...</p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        base = 10

                        def multiply(number):
                            return base * number

                        def add(number):
                            return base + number

                        print(multiply(5))  # ...50
                        print(add(7))       # ...12



                        .
                    </code>
                </pre>
            </section>
            <section data-transition="fade-in fade-out">
                <p>Calculations on top of a <strong>second</strong> number</p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        base = 10

                        def multiply(number):
                            return base * number

                        def add(number):
                            return base + number

                        print(multiply(5))  # ...50
                        print(add(7))       # ...12

                        base = 6
                        print(multiply(5))  # ...30
                        print(add(7))       # ...13
                    </code>
                </pre>
            </section>
            <section data-transition="fade-in fade-out">
                <p>Separation of <strong>state</strong>...</p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        <mark>base = 10</mark>

                        def multiply(number):
                            return base * number

                        def add(number):
                            return base + number

                        print(multiply(5))  # ...50
                        print(add(7))       # ...12

                        <mark>base = 6</mark>
                        print(multiply(5))  # ...30
                        print(add(7))       # ...13
                    </code>
                </pre>
            </section>
            <section data-transition="fade-in slide-out">
                <p>...and <strong>behaviour</strong></p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        base = 10

                        <mark>def multiply(number):</mark>
                            return base * number

                        <mark>def add(number):</mark>
                            return base + number

                        print(multiply(5))  # ...50
                        print(add(7))       # ...12

                        base = 6
                        print(multiply(5))  # ...30
                        print(add(7))       # ...13
                    </code>
                </pre>
            </section>
            <section>
                <h4>
                    Using classes to redesign the calculator
                </h4>
                <br/>
                <ul>
                    <li>A class is a <strong>blueprint</strong> for objects</li>
                    <li>An object <strong>encapsulates</strong> data as well as methods</li>
                </ul>
            </section>
            <section data-transition="slide-in fade-out">
                <p>API Design first ...</p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        calculator = <mark>Calculator(base=10)</mark>
                        print(calculator.multiply_by(5))
                        print(calculator.add(7))
                    </code>
                </pre>
            </section>
            <section data-transition="fade-in slide-out">
                <p>API Design first ...</p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        calculator = Calculator(base=10)
                        print(calculator.<mark>multiply_by(5)</mark>)
                        print(calculator.<mark>add(7)</mark>)
                    </code>
                </pre>
              </section>
              <section>
                <p>Different calculators are now separate objects ...</p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        <mark>base_ten_calc</mark> = Calculator(base=10)
                        print(base_ten_calc.multiply_by(5)) # ...50
                        print(base_ten_calc.add(7))         # ...17

                        <mark>base_six_calc</mark> = Calculator(base=6)
                        print(base_six_calc.multiply_by(5)) # ...30
                        print(base_six_calc.add(7))         # ...13
                    </code>
                </pre>
            </section>
            <section data-transition="slide-in fade-out">
                <p>Implementation</p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        class Calculator:
                            def __init__(self, base):
                                self.base = base

                            def multiply_by(self, number):
                                return self.base * number

                            def add(self, number):
                                return self.base + number
                    </code>
                </pre>
            </section>
            <section data-transition="fade-in">
                <p>Implementation</p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        class Calculator:
                            <mark>def __init__(self, base):</mark>
                                <mark>self.base = base</mark>

                            def multiply_by(self, number):
                                return self.base * number

                            def add(self, number):
                                return self.base + number
                    </code>
                </pre>
            </section>
            <section data-transition="fade-in slide-out">
                <p>Implementation</p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        class Calculator:
                            def __init__(self, base):
                                self.base = base

                            <mark>def multiply_by(self, number):</mark>
                                <mark>return self.base * number</mark>

                            def add(self, number):
                                return self.base + number
                    </code>
                </pre>
            </section>
            <section data-transition="slide-in fade-out">
                <p>
                    A real-world example - <br/>
                    Syncing a file between SFTP and S3
                </p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        s2s_sync = Sftp2S3(server_name='a.b.c', bucket_name='my-bucket')

                        s2s_sync.sync_file('foo.txt')
                        s2s_sync.sync_file('baz/bar.txt')
                    </code>
                </pre>
            </section>
            <section data-transition="fade-in">
                <p>
                    A real-world example - <br/>
                    Syncing a file between SFTP and S3
                </p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        s2s_sync = <mark>Sftp2S3(server_name='a.b.c', bucket_name='my-bucket')</mark>

                        s2s_sync.sync_file('foo.txt')
                        s2s_sync.sync_file('baz/bar.txt')
                    </code>
                </pre>
            </section>
            <section data-transition="fade-in slide-out">
                <p>
                    A real-world example - <br/>
                    Syncing a file between SFTP and S3
                </p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        s2s_sync = Sftp2S3(server_name='a.b.c', bucket_name='my-bucket')

                        s2s_sync.<mark>sync_file('foo.txt')</mark>
                        s2s_sync.<mark>sync_file('baz/bar.txt')</mark>
                    </code>
                </pre>
            </section>
            <section data-transition="slide-in fade-out">
                <p>Implementation Design</p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        class Sftp2S3:
                            def __init__(self, server_name, bucket_name):
                                self.bucket = boto3.resource('s3').Bucket(bucket_name)
                                self.sftp_server = self._init_sftp(server_name)

                            def _init_sftp(self, server_name): pass
                            def _needs_sync(self, file_name): pass
                            def _copy_from_sftp(self, file_name): pass

                            def sync_file(self, file_name):
                                if (self._needs_sync(file_name)):
                                    self._copy_from_sftp(file_name)
                    </code>
                </pre>
            </section>
            <section data-transition="fade-in">
                <p>Implementation Design</p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        class Sftp2S3:
                            <mark>def __init__(self, server_name, bucket_name):</mark>
                                <mark>self.bucket = boto3.resource('s3').Bucket(bucket_name)</mark>
                                <mark>self.sftp_server = self._init_sftp(server_name)</mark>

                            def _init_sftp(self, server_name): pass
                            def _needs_sync(self, file_name): pass
                            def _copy_from_sftp(self, file_name): pass

                            def sync_file(self, file_name):
                                if (self._needs_sync(file_name)):
                                    self._copy_from_sftp(file_name)
                    </code>
                </pre>
            </section>
            <section data-transition="fade-in slide-out">
                <p>Implementation Design</p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        class Sftp2S3:
                            def __init__(self, server_name, bucket_name):
                                self.bucket = boto3.resource('s3').Bucket(bucket_name)
                                self.sftp_server = self._init_sftp(server_name)

                            def _init_sftp(self, server_name): pass
                            def _needs_sync(self, file_name): pass
                            def _copy_from_sftp(self, file_name): pass

                            <mark>def sync_file(self, file_name):</mark>
                                <mark>if (self._needs_sync(file_name)):</mark>
                                    <mark>self._copy_from_sftp(file_name)</mark>
                    </code>
                </pre>
            </section>
            <section>
                <h4>This was just a sneak peek into classes</h4>
                <br/>
                <ul>
                    <li><strong>Re-use</strong> code elsewhere</li>
                    <li>Utilize <strong>inheritance</strong> to implement your own <strong>generators</strong>, <strong>collections</strong> ...</li>
                    <li>And ...</li>
                </ul>
            </section>
            <section>
                <p>Unit Testing</p>
                <pre>
                    <code class="python" data-trim data-noescape>
                        class TestCalculator(TestCase):

                            def test_multiply_with_zero_is_zero(self):
                                # setup
                                calc = Calculator(29)

                                # exercise
                                result = calc.multiply_by(0)

                                # verify
                                self.assertEqual(0, result)
                    </code>
                </pre>
            </section>
            <section data-background="#f7f2d3">
                <h2>Tip #4</h2>
                <p>Encapsulate behaviour as well as state</p>
                <p>Use classes - The door to a whole new world</p>
            </section>
        </section>

        <!-- Use an IDE -->
        <section>
            <section>
                <h2>The right tool for the job</h2>
            </section>
            <section>
                <p>What does this code print?</p>
                <img src="resources/faculty.png">
            </section>
            <section>
                <p>... not much</p>
                <img src="resources/pycharm.png">
            </section>
            <section>
                Can <i><strike>vim</strike> <strike>emacs</strike> <strike>sublime</strike></i> a text editor do this?
            </section>
            <section>
                <p>Remove unused imports ...</p>
                <img src="resources/import.png">
            </section>
            <section>
                <p>Reformat code according to Python standards ...</p>
                <img src="resources/reformat.png">
            </section>
            <section>
                <p>Throw in a breakpoint ...</p>
                <img src="resources/debugger.png">
            </section>
            <section>
                <p>Change a method name across the whole project ...</p>
                <img src="resources/refactor.png">
            </section>
            <section data-background="#f7f2d3">
                <h2>Tip #5</h2>
                <p>Python is a high-level programming language.</p>
                <p>Use an IDE.
                <p>
                <p>Just because you can.</p>
            </section>
        </section>

        <!-- Language Features-->
        <section>
            <section>
                <h2>Language Features</h2>
            </section>
            <section data-transition="slide-in fade-out">
                <p>Using Jinja templates to generate Jenkins pipelines</p>
                <pre data-badge="pipeline.groovy">
                    <code class="groovy" data-trim data-noescape>
                        GIT_BRANCHES = ['master', 'development']
                        ...
                        for (branch in GIT_BRANCHES) {
                            ...
                        }
                    </code>
                </pre>
                <pre data-badge="config.yml" class="fragment">
                    <code class="yaml" data-trim data-noescape>
                        git:
                            branches:
                            - master
                            - development
                    </code>
                </pre>
                <pre data-badge="pipeline.groovy.j2" class="fragment">
                    <code class="python" data-trim data-noescape>
                        GIT_BRANCHES = {{ git.branches}}  # Does not come out as a groovy literal...
                    </code>
                </pre>
            </section>
            <section data-transition="fade-in slide-out">
                <p>Using Jinja templates to generate Jenkins pipelines</p>
                <pre data-badge="pipeline.groovy">
                    <code class="groovy" data-trim data-noescape>
                        GIT_BRANCHES = ['master', 'development']
                        ...
                        for (branch in GIT_BRANCHES) {
                            ...
                        }
                    </code>
                </pre>
                <pre data-badge="config.yml">
                    <code class="yaml" data-trim data-noescape>
                        git:
                            branches:
                            - master
                            - development
                    </code>
                </pre>
                <pre data-badge="pipeline.groovy.j2">
                    <code class="python" data-trim data-noescape>
                        GIT_BRANCHES = {{ git.branches <mark>| to_groovy_list</mark> }} # Custom Jinja filter...
                    </code>
                </pre>
            </section>
            <section data-transition="slide-in fade-out">
                <p>Registering a custom Jinja filter</p>
                <pre data-badge="render_pipeline1.py">
                    <code class="python" data-trim data-noescape>
                        from jinja2 import Environment

                        jinja_env = Environment()  # [...]
                        jinja_env.filters['quoted'] = quoted
                        jinja_env.filters['to_groovy_list'] = to_groovy_list

                        def quoted(text):
                            return "'{}'".format(text)

                        def to_groovy_list(list):
                            return '[{}]'.format(', '.join(map(quoted, list)))
                    </code>
                </pre>
            </section>
            <section data-transition="fade-in fade-out">
                <p>Registering a custom Jinja filter</p>
                <pre data-badge="render_pipeline1.py">
                    <code class="python" data-trim data-noescape>
                        from jinja2 import Environment

                        jinja_env = Environment()  # [...]
                        jinja_env.filters['quoted'] = quoted
                        jinja_env.filters['to_groovy_list'] = to_groovy_list

                        def quoted(text):
                            return "'{}'".format(text)

                        <mark>def to_groovy_list(list):</mark>
                            <mark>return '[{}]'.format(', '.join(map(quoted, list)))</mark>
                    </code>
                </pre>
            </section>
            <section data-transition="fade-in slide-out">
                <p>Registering a custom Jinja filter</p>
                <pre data-badge="render_pipeline1.py">
                    <code class="python" data-trim data-noescape>
                        from jinja2 import Environment

                        jinja_env = Environment()  # [...]
                        jinja_env.filters['quoted'] = quoted
                        <mark>jinja_env.filters['to_groovy_list'] = to_groovy_list</mark>

                        def quoted(text):
                            return "'{}'".format(text)

                        def to_groovy_list(list):
                            return '[{}]'.format(', '.join(map(quoted, list)))
                    </code>
                </pre>
            </section>
            <section data-transition="slide-in fade-out">
                <p>The same, using a decorator</p>
                <pre data-badge="render_pipeline2.py">
                    <code class="python" data-trim data-noescape>
                        jinja_env = Environment()  # [...]

                        def custom_filter(func):
                            jinja_env.filters[func.__name__] = func

                        @custom_filter
                        def quoted(text):
                            return "'{}'".format(text)

                        @custom_filter
                        def to_groovy_list(list):
                            return '[{}]'.format(', '.join(map(quoted, list)))
                    </code>
                </pre>
            </section>
            <section data-transition="fade-in slide-out">
                <p>The same, using a decorator</p>
                <pre data-badge="render_pipeline2.py">
                    <code class="python" data-trim data-noescape>
                        jinja_env = Environment()  # [...]

                        <mark>def custom_filter(func):</mark>
                            jinja_env.filters[func.__name__] = func

                        <mark>@custom_filter</mark>
                        def quoted(text):
                            return "'{}'".format(text)

                        <mark>@custom_filter</mark>
                        def to_groovy_list(list):
                            return '[{}]'.format(', '.join(map(quoted, list)))
                    </code>
                </pre>
            </section>
            <section>
                <p>Implementing a CLI tool</p>
                <pre data-badge="deploy.sh">
                    <code class="plaintext" data-trim data-noescape>
                        query-nexus.py \
                        --nexus-url 'https://nexus.local' \
                        --repo 'maven-releases' \
                        --group 'com.company.ms' \
                        --artifact 'my-api' \
                        --version '1.0.8'
                    </code>
                </pre>
            </section>
            <section>
                <p>Using argparse</p>
                <pre data-badge="query-nexus1.py">
                    <code class="python" data-trim data-noescape>
                        parser = argparse.ArgumentParser('Get Swagger URL')
                        parser.add_argument('--nexus-url', nargs='?', default='…', help='…')
                        parser.add_argument('--repo', nargs='?', default='…', help='…')
                        parser.add_argument('--group', nargs='?', default='…', help='…')
                        parser.add_argument('--artifact', nargs='?', help='…')
                        parser.add_argument('--version', nargs='?', help='…')
                        parser.add_argument('--debug', action='store_true')
                        args = parser.parse_args()
                    </code>
                </pre>
            </section>
            <section>
                <p>Using the Click framework</p>
                <pre data-badge="query-nexus2.py">
                    <code class="python" data-trim data-noescape>
                        @click_command
                        @click.option('--nexus-url', '-n', default='…', help='…')
                        @click.option('--repo', '-r', default='…', help='…')
                        @click.option('--group', '-g', default='…', help='…')
                        @click.option('--artifact', '-a', default='…', help='…')
                        @click.option('--version', '-v', default='…', help='…')
                        @click.option('--debug', '-d', default='…', help='…')
                        def retrieve_swagger_url(nexus_url, repo, group, artefact, version, debug):
                            pass
                    </code>
                </pre>
            </section>
            <section data-background="#f7f2d3">
                <h2>Tip #6</h2>
                <p>Look around.</p>
            </section>
        </section>

        <!-- Outro -->
        <section>
            <section>
                <h2>The End &#9786;</h2>
            </section>
            <section>
                <p>I hope you find it useful
                    <br/>
                    Or ...
                </p>
            </section>
            <section>
                <p>
                    Tim Peters, Python core developer:
                </p>
                <blockquote>
                    Here's the plan:<br/>
                    When someone uses a feature you don’t understand, simply <strong>shoot</strong> them. This is <strong>easier than learning</strong> something new, and before too long the only living coders will be writing in an easily understood, tiny subset of Python 0.9.6 ;-)
                </blockquote>
            </section>
            <section>
                <p>
                    The talk
                    <br />
                    <a href="https://jangroth.github.io/linuxconf2019">jangroth.github.io/linuxconf2019</a>
                </p>
                <br/>
                <br/>
                <p>
                    References and more reading
                    <br/>
                    <a href="https://github.com/jangroth/linuxconf2019">github.com/jangroth/linuxconf2019</a>
                </p>
            </section>
        </section>

    </div>
</div>

<script src="reveal/lib/js/head.min.js"></script>
<script src="reveal/js/reveal.js"></script>
<script>
    Reveal.initialize({
        // presentation size
        width: 1280,
        height: 720,
        margin: 0.1,
        minScale: 0.2,
        maxScale: 1.5,

        // elapsed-time-bar
        allottedTime: 25 * 60 * 1000, // 25 minutes
        progressBarHeight: 5,

        // reveal
        history: true,
        progress: true,
        hideAddressBar: true,
        dependencies: [
                        { src: 'reveal/plugin/elapsed-time-bar/elapsed-time-bar.js' },
                        { src: 'reveal/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                        { src: 'reveal/plugin/badges/badges.js'}
                    ]
        });
</script>
</body>
</html>
